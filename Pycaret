# -*- coding: utf-8 -*-
"""Pycaret.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Qxspni9Eo4KOCZtnexg7LY3fojBA0UYD
"""

!pip install pycaret

import pandas as pd
from pycaret.classification import *

!wget "https://www.dropbox.com/s/23qpng1ankvff8h/test_titanic.csv"
!wget "https://www.dropbox.com/s/zt500ukc8jb52vy/train_titanic.csv"

train_titanic = pd.read_csv('train_titanic.csv')
test_titanic = pd.read_csv('test_titanic.csv')
test_titanic.head()

classification_setup = setup(data= train_titanic, target='Survived',remove_outliers=True,normalize=True,normalize_method='robust',
                            ignore_features= ['Name'],session_id = 6563)

compare_models(exclude = ['lda'])

dt = create_model('dt')

"""<div align='left'><font size="5" color="#FF0000">Interpretation</font></div>
<hr>
"""

plot_model(estimator = dt, plot = 'feature')

rd = create_model('ridge');
lgm  = create_model('lightgbm');

#blending 3 models
blend = blend_models(estimator_list=[lgm,dt,rd])

plot_model(estimator = blend, plot = 'confusion_matrix')

pred = predict_model(blend, data = test_titanic)

output = pd.DataFrame({'PassengerId': test_titanic.PassengerId, 'Survived': train_titanic.Survived})
output.to_csv('submission.csv', index=False)

output.head()
